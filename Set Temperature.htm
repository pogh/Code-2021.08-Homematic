<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" type="text/css" href="./druckansicht.css">
</head>

<body><br>
  <div id="printDiv">
    <table id="ProgramTable" class="filterTable tTable j_translate" style="display: table;" cellspacing="0"
      cellpadding="0" border="0">
      <thead>
        <tr>
          <td class="thCell CLASS04802">Name</td>
          <td class="thCell CLASS04802">Description</td>
          <td class="thCell CLASS04802">Condition (if...)</td>
          <td class="thCell CLASS04802">Activity (then..., or else...)</td>
          <td class="thCell CLASS04802">Action</td>
        </tr>
      </thead>
      <tbody>
        <tr class="CLASS04803">
          <td class="tBodyCell bgWhite taCenter" id="prg5943name">Set
            Temperature</td>
          <td class="tBodyCell bgWhite taCenter" id="prg5943desc">
          </td>
          <td class="tBodyCell"> <i>within value range</i> Channel status: Bathroom Radiator Thermostat:1 Actual
            temperature more or equal 1.00° C trigger when updated</td>
          <td class="tBodyCell">System status: Log Message immediately to Set Temperature set</td>
          <td class="tBodyCell bgWhite"><input type="checkbox" onchange="isePrograms.SetVisibility(5943,this.checked);"
              id="p5943_systeminternal"><label for="p5943_systeminternal">intrinsic</label></td>
        </tr>
        <tr>
          <td colspan="5">
            <div id="prgrulecontent">
              <div id="rule5944" class="conditionEven">
                <div class="Rule j_translate" style="display: block;">
                  <div class="CLASS02300">Condition: If...</div>
                  <div class="Condition">
                    <div><span id="sico5952"><b><u>Device selection</u><b></b></b> <b class="CLASS02201">Bathroom Radiator Thermostat:1</b> <i>when</i>
                        <b><u>Actual temperature</u><b></b></b> <i>within value range</i> <b class="CLASS02201">more or equal 1.00°C</b>&nbsp;<b><u>trigger
                            when updated</u><b></b></b>
                      </span> </div>
                    <div><b>OR</b></div>
                    <div><span id="sico5953"><b><u>Device selection</u><b></b></b> <b class="CLASS02201">Bedroom Radiator Thermostat:1</b> <i>when</i>
                        <b><u>Actual temperature</u><b></b></b> <i>within value range</i> <b class="CLASS02201">more or equal 1.00°C</b>&nbsp;<b><u>trigger
                            when updated</u><b></b></b>
                      </span> </div>
                    <div><b>OR</b></div>
                    <div><span id="sico5954"><b><u>Device selection</u><b></b></b> <b class="CLASS02201">Kitchen Radiator Thermostat:1</b> <i>when</i>
                        <b><u>Actual temperature</u><b></b></b> <i>within value range</i> <b class="CLASS02201">more or equal 1.00°C</b>&nbsp;<b><u>trigger
                            when updated</u><b></b></b>
                      </span> </div>
                    <div><b>OR</b></div>
                    <div><span id="sico5955"><b><u>Device selection</u><b></b></b> <b class="CLASS02201">Lounge Radiator Thermostat:1</b> <i>when</i> <b><u>Actual
                            temperature</u><b></b></b> <i>within value range</i> <b class="CLASS02201">more or equal 1.00°C</b>&nbsp;<b><u>trigger
                            when updated</u><b></b></b>
                      </span> </div><span></span>
                  </div>
                  <div><span><b><u>OR</u><b></b></b></span></div>
                </div>
                <div class="Rule">
                  <div class="CLASS02300">Activity: Then...<label><input type="checkbox" checked="checked" class="SelectBox">Stop all
                      current delays before performing the activity (e.g. retriggering).</label></div>
                  <div><span id="side5956"><b><u>System state</u><b></b></b> <b class="CLASS02400">Log Message</b> <b><u>immediately</u><b></b></b>
                      <b><u>Set Temperature</u></b>
                    </span> </div>
                  <div><span id="side5957"><b><u>Script</u><b></b></b> <br>
                      <pre>string deviceId;<br>object device;<br><br>integer deviceCount = 0;<br>real temperatureTotal = 0.0;<br>real temperatureLow = 99;<br><br>foreach(deviceId, dom.GetObject(ID_DEVICES).EnumUsedIDs()) {<br>  var device = dom.GetObject(deviceId);<br>  if((device.HssType() == "HmIP-eTRV-2")<br>  ||(device.HssType() == "HmIP-eTRV-2 I9F")<br>  ) {<br>        var channel = device.Channels().GetAt(1);<br>        var dp  = channel.DPByHssDP("ACTUAL_TEMPERATURE");<br>        <br>        WriteLine(device # ": " # dp.Value());<br><br>        if(dp.Value() &gt; 0)<br>        {<br>            deviceCount = deviceCount + 1;<br>            temperatureTotal = temperatureTotal + dp.Value();<br>        }<br>        if(dp.Value() &lt; temperatureLow)<br>        {<br>            temperatureLow = dp.Value();<br>        }<br>  }<br>}<br><br>real temperature = (temperatureTotal / deviceCount);<br>real savedtemperature = dom.GetObject("TemperatureCurrent").Value();<br><br>WriteLine("");<br>WriteLine("Temperature: " # temperature);<br>WriteLine("Savedtemperature: " # savedtemperature);<br>WriteLine("TemperatureLow: " # temperatureLow);<br>WriteLine("");<br><br>if(<br>    ((temperature - savedtemperature) &gt; 0.25)<br>    ||<br>    ((savedtemperature - temperature) &gt; 0.25)<br>)<br>{<br>    string newtemperature = temperature.ToString();<br><br>    newtemperature = newtemperature.Substr(0, newtemperature.Find(".") + 2);<br>    dom.GetObject("TemperatureCurrent").State(newtemperature);<br><br>    if (newtemperature == "-0") {<br>        newtemperature = "0";<br>    }<br><br>    newtemperature = newtemperature + dom.GetObject("Degree Symbol").Value() + "C"; !Find() + 0 ==&gt; Homematic Bug<br>    dom.GetObject("TemperaturCurrentDisplay").State(newtemperature);<br><br>    dom.GetObject("IsStatusDisplayNeedsUpdate").State(true);<br>}<br><br>if(<br>    (temperatureLow == 0)<br>    &amp;&amp; <br>    (dom.GetObject("TemperatureIsLow").Value() != false)<br>)<br>{<br>    dom.GetObject("TemperatureIsLow").State(false);<br>}<br><br>if(<br>    (temperatureLow != 0)<br>    &amp;&amp;<br>    (temperatureLow &lt; 14)<br>    &amp;&amp; <br>    (dom.GetObject("TemperatureIsLow").Value() != true)<br>)<br>{<br>    dom.GetObject("TemperatureIsLow").State(true);<br>}<br><br>if(<br>    (temperatureLow != 0)<br>    &amp;&amp;<br>    (temperatureLow &gt;= 14)<br>    &amp;&amp; <br>    (dom.GetObject("TemperatureIsLow").Value() != false)<br>)<br>{<br>    dom.GetObject("TemperatureIsLow").State(false);<br>}</pre>
                      <br> <b><u>immediately</u><b></b></b>
                    </span> </div><span></span>
                </div>
                <div class="Rule">
                  <div class="CLASS02300">Activity:<b><u>Else...</u><b></b></b><label><input type="checkbox" class="SelectBox">Stop all
                      current delays before performing the activity (e.g. retriggering).</label></div><span></span>
                </div>
              </div>

            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div><br>
</body>

</html>